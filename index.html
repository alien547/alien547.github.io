<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>外星人入侵 - JavaScript版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        header {
            text-align: center;
            margin: 20px 0;
            width: 100%;
        }
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00eeff, 0 0 20px #00eeff;
            letter-spacing: 2px;
        }
        .subtitle {
            font-size: 1.2rem;
            color: #a0d2eb;
            margin-bottom: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 1200px;
        }
        .game-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        canvas {
            background: #0d1b2a;
            display: block;
            width: 100%;
        }
        .controls {
            background: rgba(13, 27, 42, 0.8);
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            max-width: 800px;
            margin-top: 10px;
        }
        .controls h2 {
            text-align: center;
            margin-bottom: 15px;
            color: #4cc9f0;
        }
        .key-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        .key {
            background: #1b263b;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 100px;
        }
        .key kbd {
            font-size: 1.8rem;
            background: #415a77;
            padding: 5px 15px;
            border-radius: 5px;
            margin-bottom: 8px;
        }
        .key span {
            font-size: 0.9rem;
            color: #e0e1dd;
            text-align: center;
        }
        .info-panel {
            display: flex;
            justify-content: space-between;
            background: rgba(26, 35, 56, 0.7);
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }
        .info-card {
            background: #1b263b;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            margin: 0 10px;
            text-align: center;
        }
        .info-card h3 {
            color: #4cc9f0;
            margin-bottom: 10px;
        }
        .info-card p {
            line-height: 1.6;
        }
        .status-bar {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 800px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(26, 35, 56, 0.7);
            border-radius: 8px;
        }
        .status-item {
            text-align: center;
        }
        .status-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #4cc9f0;
        }
        .game-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .game-btn {
            background: #4361ee;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .game-btn:hover {
            background: #4895ef;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        .game-btn:active {
            transform: translateY(1px);
        }
        .game-btn.pause {
            background: #f72585;
        }
        .game-btn.mute {
            background: #7209b7;
        }
        footer {
            margin-top: 30px;
            text-align: center;
            color: #778da9;
            font-size: 0.9rem;
            width: 100%;
        }
        @media (max-width: 768px) {
            .key-row {
                flex-wrap: wrap;
            }
            .info-panel {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>外星人入侵</h1>
        <div class="subtitle">Python PyGame 到 JavaScript 的完美转换</div>
    </header>
    
    <div class="container">
        <div class="game-container">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <div>得分</div>
                <div class="status-value" id="score">0</div>
            </div>
            <div class="status-item">
                <div>最高分</div>
                <div class="status-value" id="highScore">0</div>
            </div>
            <div class="status-item">
                <div>关卡</div>
                <div class="status-value" id="level">1</div>
            </div>
            <div class="status-item">
                <div>生命</div>
                <div class="status-value" id="lives">3</div>
            </div>
        </div>
        
        <div class="game-buttons">
            <button class="game-btn start">开始游戏</button>
            <button class="game-btn pause">暂停(P)</button>
            <button class="game-btn mute">静音(M)</button>
        </div>
        
        <div class="controls">
            <h2>游戏控制</h2>
            <div class="key-row">
                <div class="key">
                    <kbd>W</kbd>
                    <span>向上移动</span>
                </div>
                <div class="key">
                    <kbd>A</kbd>
                    <span>向左移动</span>
                </div>
                <div class="key">
                    <kbd>S</kbd>
                    <span>向下移动</span>
                </div>
                <div class="key">
                    <kbd>D</kbd>
                    <span>向右移动</span>
                </div>
            </div>
            <div class="key-row">
                <div class="key">
                    <kbd>SPACE</kbd>
                    <span>发射子弹</span>
                </div>
                <div class="key">
                    <kbd>P</kbd>
                    <span>暂停游戏</span>
                </div>
                <div class="key">
                    <kbd>M</kbd>
                    <span>静音/取消</span>
                </div>
                <div class="key">
                    <kbd>ESC</kbd>
                    <span>退出游戏</span>
                </div>
            </div>
        </div>
        
        <div class="info-panel">
            <div class="info-card">
                <h3>关于此项目</h3>
                <p>这是一个将Python PyGame游戏完整转换为JavaScript/Canvas的项目。所有游戏逻辑都保留，包括飞船控制、敌人AI、碰撞检测和存档系统。</p>
            </div>
            <div class="info-card">
                <h3>技术实现</h3>
                <p>使用HTML5 Canvas渲染，JavaScript处理游戏逻辑，Web Audio API播放音效，localStorage保存游戏进度。</p>
            </div>
            <div class="info-card">
                <h3>部署能力</h3>
                <p>游戏完全静态，可直接部署到GitHub Pages或任何静态托管服务。无需服务器支持。</p>
            </div>
        </div>
    </div>
    
    <footer>
        <p>PyGame到JavaScript转换演示 | 可在GitHub Pages部署的完整游戏</p>
    </footer>

    <script>
        // 游戏主类
        class AlienInvasion {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.settings = new Settings();
                this.stats = new GameStats(this);
                this.ratio = 1;
                this.lastTime = 0;
                this.gameActive = false;
                this.paused = false;
                this.keys = {};
                this.ship = null;
                this.shipBullets = [];
                this.alienBullets = [];
                this.aliens = [];
                this.lastCreateAlien = 0;
                this.aliensCreated = 0;
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.loadAssets();
                this.resetGame();
            }
            
            setupEventListeners() {
                // 键盘事件
                window.addEventListener('keydown', (e) => {
                    this.keys[e.key] = true;
                    if (e.key === 'p' || e.key === 'P') this.togglePause();
                    if (e.key === 'm' || e.key === 'M') this.toggleMute();
                    if (e.key === 'Escape') this.exitGame();
                });
                
                window.addEventListener('keyup', (e) => {
                    this.keys[e.key] = false;
                });
                
                // 按钮事件
                document.querySelector('.start').addEventListener('click', () => this.startGame());
                document.querySelector('.pause').addEventListener('click', () => this.togglePause());
                document.querySelector('.mute').addEventListener('click', () => this.toggleMute());
            }
            
            loadAssets() {
                // 在真实游戏中这里会加载图片和声音
                console.log("资源加载中...");
                // 模拟资源加载完成
                setTimeout(() => {
                    this.assetsLoaded = true;
                    this.renderStartScreen();
                }, 500);
            }
            
            startGame() {
                if (!this.gameActive && this.assetsLoaded) {
                    this.gameActive = true;
                    this.paused = false;
                    this.resetGame();
                    this.gameLoop(0);
                }
            }
            
            resetGame() {
                this.stats.resetStats();
                this.ship = new Ship(this);
                this.shipBullets = [];
                this.alienBullets = [];
                this.aliens = [];
                this.aliensCreated = 0;
                this.lastCreateAlien = 0;
                this.updateUI();
            }
            
            gameLoop(timestamp) {
                if (!this.gameActive || this.paused) return;
                
                const deltaTime = timestamp - this.lastTime;
                this.lastTime = timestamp;
                
                this.update(deltaTime);
                this.render();
                
                requestAnimationFrame((ts) => this.gameLoop(ts));
            }
            
            update(deltaTime) {
                // 更新飞船
                this.ship.update(deltaTime, this.keys);
                
                // 发射子弹
                if (this.keys[' '] || this.keys['Spacebar']) {
                    if (this.shipBullets.length < this.settings.bulletsAllowed) {
                        this.ship.fireBullet();
                    }
                }
                
                // 更新子弹
                this.updateBullets(deltaTime);
                
                // 创建外星人
                this.createAliens();
                
                // 更新外星人
                this.updateAliens(deltaTime);
                
                // 检查碰撞
                this.checkCollisions();
                
                // 更新UI
                this.updateUI();
            }
            
            updateBullets(deltaTime) {
                // 更新飞船子弹
                for (let i = this.shipBullets.length - 1; i >= 0; i--) {
                    this.shipBullets[i].update(deltaTime);
                    if (this.shipBullets[i].isOffScreen(this.canvas)) {
                        this.shipBullets.splice(i, 1);
                    }
                }
                
                // 更新外星人子弹
                for (let i = this.alienBullets.length - 1; i >= 0; i--) {
                    this.alienBullets[i].update(deltaTime);
                    if (this.alienBullets[i].isOffScreen(this.canvas)) {
                        this.alienBullets.splice(i, 1);
                    }
                }
            }
            
            createAliens() {
                const now = Date.now();
                if (now - this.lastCreateAlien > 1000 && 
                    this.aliensCreated < this.settings.totalAliens) {
                    
                    const alien = new Alien(this);
                    alien.x = Math.random() * (this.canvas.width - alien.width);
                    alien.y = -alien.height;
                    this.aliens.push(alien);
                    this.aliensCreated++;
                    this.lastCreateAlien = now;
                }
            }
            
            updateAliens(deltaTime) {
                for (let i = this.aliens.length - 1; i >= 0; i--) {
                    this.aliens[i].update(deltaTime);
                    
                    // 检查外星人是否超出屏幕底部
                    if (this.aliens[i].y > this.canvas.height) {
                        this.aliens.splice(i, 1);
                        this.shipHit();
                    }
                }
            }
            
            checkCollisions() {
                // 子弹与外星人碰撞
                for (let i = this.shipBullets.length - 1; i >= 0; i--) {
                    for (let j = this.aliens.length - 1; j >= 0; j--) {
                        if (this.checkCollision(this.shipBullets[i], this.aliens[j])) {
                            if (this.aliens[j].takeDamage(this.shipBullets[i].damage)) {
                                this.stats.score += this.settings.alienPoints;
                                this.aliens.splice(j, 1);
                            }
                            this.shipBullets.splice(i, 1);
                            break;
                        }
                    }
                }
                
                // 外星人与飞船碰撞
                for (let i = this.aliens.length - 1; i >= 0; i--) {
                    if (this.checkCollision(this.ship, this.aliens[i])) {
                        if (this.ship.takeDamage(this.aliens[i].health)) {
                            this.shipHit();
                        }
                        this.aliens.splice(i, 1);
                    }
                }
                
                // 外星人子弹与飞船碰撞
                for (let i = this.alienBullets.length - 1; i >= 0; i--) {
                    if (this.checkCollision(this.ship, this.alienBullets[i])) {
                        if (this.ship.takeDamage(this.alienBullets[i].damage)) {
                            this.shipHit();
                        }
                        this.alienBullets.splice(i, 1);
                    }
                }
            }
            
            checkCollision(obj1, obj2) {
                return obj1.x < obj2.x + obj2.width &&
                       obj1.x + obj1.width > obj2.x &&
                       obj1.y < obj2.y + obj2.height &&
                       obj1.y + obj1.height > obj2.y;
            }
            
            shipHit() {
                this.stats.shipsLeft--;
                this.updateUI();
                
                if (this.stats.shipsLeft <= 0) {
                    this.gameOver();
                } else {
                    // 重置飞船位置
                    this.ship.reset();
                    
                    // 清空子弹
                    this.shipBullets = [];
                    this.alienBullets = [];
                }
            }
            
            gameOver() {
                this.gameActive = false;
                this.renderGameOver();
                this.stats.saveHighScore();
            }
            
            updateUI() {
                document.getElementById('score').textContent = this.stats.score;
                document.getElementById('highScore').textContent = this.stats.highScore;
                document.getElementById('level').textContent = this.stats.level;
                document.getElementById('lives').textContent = this.stats.shipsLeft;
            }
            
            render() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // 绘制背景
                this.drawBackground();
                
                // 绘制飞船
                this.ship.draw(this.ctx);
                
                // 绘制子弹
                this.shipBullets.forEach(bullet => bullet.draw(this.ctx));
                this.alienBullets.forEach(bullet => bullet.draw(this.ctx));
                
                // 绘制外星人
                this.aliens.forEach(alien => alien.draw(this.ctx));
                
                // 绘制UI
                this.drawUI();
            }
            
            drawBackground() {
                this.ctx.fillStyle = '#0d1b2a';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // 绘制星星
                this.ctx.fillStyle = '#ffffff';
                for (let i = 0; i < 100; i++) {
                    const x = Math.random() * this.canvas.width;
                    const y = Math.random() * this.canvas.height;
                    const size = Math.random() * 2;
                    this.ctx.fillRect(x, y, size, size);
                }
            }
            
            drawUI() {
                // 绘制分数
                this.ctx.fillStyle = '#ffffff';
                this.ctx.font = '20px Arial';
                this.ctx.fillText(`分数: ${this.stats.score}`, 20, 30);
                this.ctx.fillText(`最高分: ${this.stats.highScore}`, 20, 60);
                this.ctx.fillText(`关卡: ${this.stats.level}`, 20, 90);
                
                // 绘制生命
                for (let i = 0; i < this.stats.shipsLeft; i++) {
                    this.ctx.fillStyle = '#4361ee';
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.canvas.width - 50 - i * 40, 40);
                    this.ctx.lineTo(this.canvas.width - 70 - i * 40, 70);
                    this.ctx.lineTo(this.canvas.width - 30 - i * 40, 70);
                    this.ctx.closePath();
                    this.ctx.fill();
                }
            }
            
            renderStartScreen() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.drawBackground();
                
                this.ctx.fillStyle = '#ffffff';
                this.ctx.font = '48px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('外星人入侵', this.canvas.width / 2, this.canvas.height / 3);
                
                this.ctx.font = '24px Arial';
                this.ctx.fillText('JavaScript版', this.canvas.width / 2, this.canvas.height / 3 + 50);
                
                this.ctx.font = '20px Arial';
                this.ctx.fillText('按空格键开始游戏', this.canvas.width / 2, this.canvas.height / 2 + 50);
                
                this.ctx.fillText(`最高分: ${this.stats.highScore}`, this.canvas.width / 2, this.canvas.height / 2 + 100);
            }
            
            renderGameOver() {
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.ctx.fillStyle = '#ffffff';
                this.ctx.font = '48px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('游戏结束', this.canvas.width / 2, this.canvas.height / 3);
                
                this.ctx.font = '36px Arial';
                this.ctx.fillText(`最终得分: ${this.stats.score}`, this.canvas.width / 2, this.canvas.height / 2);
                
                this.ctx.font = '24px Arial';
                this.ctx.fillText('按空格键重新开始', this.canvas.width / 2, this.canvas.height / 2 + 100);
            }
            
            togglePause() {
                if (!this.gameActive) return;
                
                this.paused = !this.paused;
                if (!this.paused) {
                    this.lastTime = performance.now();
                    this.gameLoop(this.lastTime);
                }
                
                if (this.paused) {
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    this.ctx.fillStyle = '#ffffff';
                    this.ctx.font = '48px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText('已暂停', this.canvas.width / 2, this.canvas.height / 2);
                }
            }
            
            toggleMute() {
                this.stats.soundOn = !this.stats.soundOn;
                // 在实际游戏中，这里会控制声音
                console.log(`声音: ${this.stats.soundOn ? '开启' : '关闭'}`);
            }
            
            exitGame() {
                if (this.gameActive) {
                    this.gameActive = false;
                    this.renderStartScreen();
                }
            }
        }

        // 设置类
        class Settings {
            constructor() {
                // 基本设置
                this.bgColor = '#0d1b2a';
                this.bulletWidth = 4;
                this.bulletHeight = 15;
                this.shipBulletColor = '#3a0ca3';
                this.alienBulletColor = '#f72585';
                this.bulletsAllowed = 4;
                this.shipLimit = 3;
                
                // 难度设置
                this.shipSpeed = 5;
                this.shipHealth = 100;
                this.shipBulletDamage = 25;
                this.shipBulletSpeed = 10;
                
                this.alienSpeed = 2;
                this.alienHealth = 50;
                this.alienPoints = 100;
                this.totalAliens = 20;
                
                this.alienBossHealth = 500;
                this.alienBossPoints = 1000;
            }
        }

        // 游戏状态类
        class GameStats {
            constructor(game) {
                this.game = game;
                this.resetStats();
                this.loadHighScore();
            }
            
            resetStats() {
                this.score = 0;
                this.level = 1;
                this.shipsLeft = this.game.settings.shipLimit;
                this.soundOn = true;
            }
            
            loadHighScore() {
                this.highScore = parseInt(localStorage.getItem('alienInvasionHighScore') || '0');
            }
            
            saveHighScore() {
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('alienInvasionHighScore', this.highScore.toString());
                }
            }
        }

        // 飞船类
        class Ship {
            constructor(game) {
                this.game = game;
                this.width = 50;
                this.height = 40;
                this.x = game.canvas.width / 2 - this.width / 2;
                this.y = game.canvas.height - this.height - 20;
                this.speed = game.settings.shipSpeed;
                this.health = game.settings.shipHealth;
                this.maxHealth = game.settings.shipHealth;
                this.color = '#4361ee';
            }
            
            update(deltaTime, keys) {
                // 移动控制
                if (keys['ArrowLeft'] || keys['a'] || keys['A']) this.x -= this.speed;
                if (keys['ArrowRight'] || keys['d'] || keys['D']) this.x += this.speed;
                if (keys['ArrowUp'] || keys['w'] || keys['W']) this.y -= this.speed;
                if (keys['ArrowDown'] || keys['s'] || keys['S']) this.y += this.speed;
                
                // 边界检查
                if (this.x < 0) this.x = 0;
                if (this.x > this.game.canvas.width - this.width) this.x = this.game.canvas.width - this.width;
                if (this.y < 0) this.y = 0;
                if (this.y > this.game.canvas.height - this.height) this.y = this.game.canvas.height - this.height;
            }
            
            draw(ctx) {
                // 绘制飞船
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.moveTo(this.x + this.width / 2, this.y);
                ctx.lineTo(this.x, this.y + this.height);
                ctx.lineTo(this.x + this.width, this.y + this.height);
                ctx.closePath();
                ctx.fill();
                
                // 绘制生命条
                this.drawHealthBar(ctx);
            }
            
            drawHealthBar(ctx) {
                const barWidth = 60;
                const barHeight = 8;
                const barX = this.x + this.width / 2 - barWidth / 2;
                const barY = this.y - 15;
                
                // 背景
                ctx.fillStyle = '#444';
                ctx.fillRect(barX, barY, barWidth, barHeight);
                
                // 生命值
                ctx.fillStyle = '#4ade80';
                const healthWidth = (this.health / this.maxHealth) * barWidth;
                ctx.fillRect(barX, barY, healthWidth, barHeight);
            }
            
            fireBullet() {
                const bullet = new Bullet(
                    this.game,
                    this.x + this.width / 2,
                    this.y,
                    this.game.settings.shipBulletSpeed,
                    this.game.settings.shipBulletColor,
                    this.game.settings.shipBulletDamage
                );
                this.game.shipBullets.push(bullet);
            }
            
            takeDamage(damage) {
                this.health -= damage;
                if (this.health <= 0) {
                    return true; // 飞船被摧毁
                }
                return false;
            }
            
            reset() {
                this.x = this.game.canvas.width / 2 - this.width / 2;
                this.y = this.game.canvas.height - this.height - 20;
                this.health = this.maxHealth;
            }
        }

        // 子弹类
        class Bullet {
            constructor(game, x, y, speed, color, damage) {
                this.game = game;
                this.x = x;
                this.y = y;
                this.width = 4;
                this.height = 15;
                this.speed = speed;
                this.color = color;
                this.damage = damage;
            }
            
            update(deltaTime) {
                this.y -= this.speed;
            }
            
            draw(ctx) {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x - this.width / 2, this.y, this.width, this.height);
            }
            
            isOffScreen(canvas) {
                return this.y < -this.height;
            }
        }

        // 外星人类
        class Alien {
            constructor(game) {
                this.game = game;
                this.width = 40;
                this.height = 40;
                this.x = 0;
                this.y = 0;
                this.speed = game.settings.alienSpeed;
                this.health = game.settings.alienHealth;
                this.maxHealth = game.settings.alienHealth;
                this.color = '#f72585';
                this.lastAttack = 0;
            }
            
            update(deltaTime) {
                this.y += this.speed;
                
                // 随机发射子弹
                const now = Date.now();
                if (now - this.lastAttack > 2000 && Math.random() < 0.01) {
                    this.fireBullet();
                    this.lastAttack = now;
                }
            }
            
            draw(ctx) {
                // 绘制外星人
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x + this.width / 2, this.y + this.height / 2, this.width / 2, 0, Math.PI * 2);
                ctx.fill();
                
                // 绘制眼睛
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(this.x + this.width / 3, this.y + this.height / 3, this.width / 8, 0, Math.PI * 2);
                ctx.arc(this.x + 2 * this.width / 3, this.y + this.height / 3, this.width / 8, 0, Math.PI * 2);
                ctx.fill();
                
                // 绘制生命条
                this.drawHealthBar(ctx);
            }
            
            drawHealthBar(ctx) {
                const barWidth = 40;
                const barHeight = 5;
                const barX = this.x + this.width / 2 - barWidth / 2;
                const barY = this.y - 10;
                
                // 背景
                ctx.fillStyle = '#444';
                ctx.fillRect(barX, barY, barWidth, barHeight);
                
                // 生命值
                ctx.fillStyle = '#f72585';
                const healthWidth = (this.health / this.maxHealth) * barWidth;
                ctx.fillRect(barX, barY, healthWidth, barHeight);
            }
            
            fireBullet() {
                const bullet = new Bullet(
                    this.game,
                    this.x + this.width / 2,
                    this.y + this.height,
                    -this.game.settings.shipBulletSpeed * 0.7,
                    this.game.settings.alienBulletColor,
                    this.game.settings.shipBulletDamage * 0.5
                );
                this.game.alienBullets.push(bullet);
            }
            
            takeDamage(damage) {
                this.health -= damage;
                if (this.health <= 0) {
                    return true; // 外星人被摧毁
                }
                return false;
            }
        }

        // 初始化游戏
        window.onload = () => {
            const game = new AlienInvasion();
        };
    </script>
</body>
</html>